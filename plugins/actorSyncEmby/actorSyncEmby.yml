name: actorSyncEmby
description: "将 Stash 中的演员信息（图片和 NFO 文件）导出到指定目录，并可选择性地将这些信息上传到 Emby 服务器。"
version: "1.0.8"
url: https://github.com/mayziran/StashtoEmby/tree/master/plugins/actorSyncEmby

settings:
  actorOutputDir:
    displayName: 演员数据输出目录
    description: "演员图片和 NFO 文件将保存到此目录下，例如：/data/actors"
    type: STRING
  exportMode:
    displayName: Task：本地导出模式
    description: "0-不导出 (默认)，1-覆盖 (图片+NFO)，2-只 NFO，3-只图片，4-补缺"
    type: NUMBER
  uploadMode:
    displayName: Task：Emby 上传模式
    description: "0-不上传 (默认)，1-覆盖 (图片 + 元数据)，2-只元数据，3-只图片，4-补缺"
    type: NUMBER
  hookMode:
    displayName: Hook 响应模式
    description: "0-关闭 Hook 响应 (默认)，1-只输出本地 (覆盖)，2-只上传 Emby(覆盖)，3-同时输出 (覆盖)"
    type: NUMBER
  embyServer:
    displayName: Emby 服务器地址
    description: "Emby 服务器地址，例如：http://192.168.1.100:8096"
    type: STRING
  embyApiKey:
    displayName: Emby API 密钥
    description: "Emby 服务器 API 密钥"
    type: STRING
  dryRun:
    displayName: 仅模拟
    description: "不真正执行任何文件操作，只输出日志"
    type: BOOLEAN
  enableWorkerLog:
    displayName: 启用新建演员异步同步日志
    description: "是否将新建演员 Hook 触发的后台异步同步脚本日志写入到 actor_sync_worker.log 文件（仅针对 Performer.Create.Post Hook，关闭后日志将完全丢弃，建议创建演员上传emby有问题可打开查看日志）"
    type: BOOLEAN

exec:
  - python
  - "{pluginDir}/actorSyncEmby.py"
interface: raw
errLog: info

tasks:
  - name: 同步所有演员
    description: "手动执行：同步所有演员信息到本地和 Emby"
    defaultArgs: {}

hooks:
  - name: syncActorOnUpdate
    description: "在演员更新后自动同步演员信息"
    triggeredBy:
      - Performer.Update.Post
    defaultArgs: {}

  - name: syncActorOnCreate
    description: "在演员创建后异步同步演员信息到 Emby（延迟执行），应当马上更新演员首支影片信息以便 emby 及时刷新演员信息"
    triggeredBy:
      - Performer.Create.Post
    defaultArgs: {}
